CREATE TABLE Books (
    book_id           INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    title             VARCHAR(255)    NOT NULL,
    author_id         INT             NOT NULL,
    publisher_id      INT             NOT NULL,
    published_date    DATE,
    isbn              VARCHAR(13)     UNIQUE,
    available_copies  INT             NOT NULL DEFAULT 1,
    CHECK (available_copies >= 0),

    FOREIGN KEY (author_id)    
        REFERENCES Authors(author_id),

    FOREIGN KEY (publisher_id) 
        REFERENCES Publishers(publisher_id)
);

CREATE TABLE Members (
    member_id        INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    first_name       VARCHAR(255)     NOT NULL,
    last_name        VARCHAR(255)     NOT NULL,
    email            VARCHAR(255)     UNIQUE NOT NULL,
    phone            VARCHAR(15),
    join_date        DATE DEFAULT CURRENT_DATE
);

CREATE TABLE Borrowing (
    borrow_id       INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY
    book_id         INT,
    member_id       INT,
    borrow_date     DATE DEFAULT CURRENT_DATE 
    return_date     DATE,

    FOREIGN KEY (book_id)
        REFERENCES Books(book_id),

    FOREIGN KEY (member_id)
        REFERENCES Members(member_id)
);

CREATE TABLE Authors (
    author_id       INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    first_name      VARCHAR(255)    NOT NULL,
    last_name       VARCHAR(255)    NOT NULL,
    bio             TEXT
);

CREATE TABLE Publishers (
    publisher_id    INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    publisher_name  VARCHAR(255)    NOT NULL,
    address         VARCHAR(255)
);